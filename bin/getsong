#!/usr/bin/env node
// Generated by LiveScript 1.5.0
(function(){
  var process, fs, ref$, exec, mkdir, ls, rm, mv, query, outfile, newname;
  process = require('process');
  fs = require('fs');
  ref$ = require('shelljs'), exec = ref$.exec, mkdir = ref$.mkdir, ls = ref$.ls, rm = ref$.rm, mv = ref$.mv;
  query = process.argv[2];
  if (fs.existsSync('getsongtmp')) {
    rm('-r', 'getsongtmp');
  }
  mkdir('getsongtmp');
  process.chdir('getsongtmp');
  exec("you-get --itag=18 '" + query + "'");
  outfile = ls('*.mp4').stdout.trim();
  mv(outfile, 'tmp.mp4');
  exec("ffmpeg -i tmp.mp4 -acodec copy -vn audio.m4a");
  newname = outfile.substr(0, outfile.length - 4) + '.m4a';
  mv('audio.m4a', '../' + newname);
  process.chdir('..');
  rm('-r', 'getsongtmp');
  console.log(newname);
}).call(this);
